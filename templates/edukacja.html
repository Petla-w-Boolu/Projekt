{% extends "base_subpage.html" %}

{% block title %}Edukacja i Kultura | eStatysta P≈Çock{% endblock %}

{% set page_id = 'edukacja' %}

{% block content_block %}
    <!-- Wewnƒôtrzny styl dla systemu zak≈Çadek (konieczny do poprawnego wy≈õwietlania) -->
    <style>
        .tabs-container {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            padding: 0 15px;
            background-color: #f7f7f7;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .tab-button {
            background-color: transparent;
            border: none;
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 600;
            color: #555;
            transition: all 0.3s ease;
            position: relative;
            top: 2px;
        }
        .tab-button.active {
            color: #1a73e8;
            border-bottom: 4px solid #1a73e8;
            background-color: #fff;
            border-radius: 4px 4px 0 0;
            padding-bottom: 8px;
        }
        .tab-button:hover:not(.active) {
            color: #1a73e8;
        }
        .tab-content {
            display: none;
            padding: 20px 0;
        }
        .tab-content.active {
            display: block;
        }
        .news-box {
            background-color: #e9f0fe;
            border-left: 5px solid #1a73e8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9em;
        }
        .control-panel {
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
    </style>

    <h2 class="page-header-title">üéì Edukacja i Kultura</h2>
    
    <!-- SEKACJA AKTUALNO≈öCI -->
    <div class="news-box" role="alert">
        <strong>üîî OsiƒÖgniƒôcia (Wrzesie≈Ñ 2024):</strong> P≈Çockie licea z 80% zdawalno≈õciƒÖ matury. Dofinansowanie dla Biblioteki Publicznej na cyfryzacjƒô zbior√≥w. Szczeg√≥≈Çy w zak≈Çadce "Wyniki Egzamin√≥w".
    </div>
    
    <!-- SEKACJA FILTR√ìW I NARZƒòDZI -->
    <div class="control-panel">
        <label for="school-type-select" style="font-weight: 600;">Filtruj wg Typu Szko≈Çy:</label>
        <select id="school-type-select" onchange="loadEducationData(this.value)" style="padding: 5px 10px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="all" selected>Wszystkie Poziomy</option>
            <option value="primary">Szko≈Çy Podstawowe</option>
            <option value="secondary">Szko≈Çy ≈örednie</option>
            <option value="higher">Szko≈Çy Wy≈ºsze</option>
        </select>
        
        <button style="margin-left: 20px; padding: 5px 15px; background-color: #1a73e8; color: white; border: none; border-radius: 4px; cursor: pointer;">
            <i class="fas fa-graduation-cap"></i> Analiza Zdolno≈õci Absolwent√≥w
        </button>
    </div>

    <!-- SYSTEM ZAK≈ÅADEK (PODKATEGORIE) -->
    <div class="tabs-container">
        <button class="tab-button active" onclick="switchTab('e_podsumowanie', this)">Podsumowanie</button>
        <button class="tab-button" onclick="switchTab('e_szkolnictwo', this)">Statystyka Szkolna</button>
        <button class="tab-button" onclick="switchTab('e_wyniki', this)">Wyniki Egzamin√≥w</button>
        <button class="tab-button" onclick="switchTab('e_kultura', this)">Instytucje Kulturalne</button>
    </div>

    <!-- TRE≈öƒÜ ZAK≈ÅADEK -->
    <div class="main-content-area">
        
        <!-- ZAK≈ÅADKA 1: PODSUMOWANIE (Aktywna domy≈õlnie) -->
        <div id="e_podsumowanie" class="tab-content active">
            <div class="data-section-grid">
                
                <div class="data-preview card">
                    <h3>≈örednia Zdawalno≈õƒá Matury (2024)</h3>
                    <p class="main-metric">78.5%</p>
                    <p class="change-info">‚Üë Wy≈ºsza o 2.1 p.p. ni≈º w 2023</p>
                </div>

                <div class="data-preview card">
                    <h3>Liczba Uczni√≥w i Student√≥w (Og√≥≈Çem)</h3>
                    <p class="main-metric">23 500</p>
                    <p class="change-info">Stabilizacja liczby student√≥w na poziomie 5.4 tys.</p>
                </div>
                
                <div class="data-preview full-width chart-container">
                    <h3>Wykres Liniowy: Liczba Uczni√≥w vs. Liczba Student√≥w (2019-2024)</h3>
                    <canvas id="educationGrowthChart"></canvas>
                </div>
            </div>
        </div>

        <!-- ZAK≈ÅADKA 2: STATYSTYKA SZKOLNA -->
        <div id="e_szkolnictwo" class="tab-content">
            <div class="data-section-grid">
                
                <div class="data-preview card">
                    <h3>Liczba Plac√≥wek (Publiczne/Prywatne)</h3>
                    <p class="main-metric">65 / 12</p>
                    <p class="change-info">Wzrost liczby szk√≥≈Ç prywatnych o 1 w 2024</p>
                </div>

                <div class="data-preview card">
                    <h3>Wydajno≈õƒá Kadry (Uczniowie/Nauczyciel)</h3>
                    <p class="main-metric">13.1</p>
                    <p class="change-info">Optymalny wska≈∫nik efektywno≈õci nauczania</p>
                </div>
                
                <div class="data-preview full-width chart-container">
                    <h3>Wykres S≈Çupkowy: Uczniowie wg Poziomu Edukacji</h3>
                    <canvas id="studentLevelChart"></canvas>
                </div>
            </div>
        </div>

        <!-- ZAK≈ÅADKA 3: WYNIKI EGZAMIN√ìW -->
        <div id="e_wyniki" class="tab-content">
            <div class="data-section-grid">
                
                <div class="data-preview card">
                    <h3>≈örednia Wynik Egzaminu √ìsmoklasisty</h3>
                    <p class="main-metric">70% (J.Pol.), 65% (Mat.)</p>
                    <p class="change-info">Matematyka ni≈ºsza o 3 p.p. ni≈º ≈õrednia krajowa</p>
                </div>

                <div class="data-preview card">
                    <h3>Udzia≈Ç Absolwent√≥w idƒÖcych na Studia</h3>
                    <p class="main-metric">65%</p>
                    <p class="change-info">DominujƒÖ kierunki techniczne i medyczne</p>
                </div>
                
                <div class="data-preview full-width chart-container">
                    <h3>Wykres Ko≈Çowy: Wyniki Maturalne (Przedmioty ObowiƒÖzkowe)</h3>
                    <canvas id="maturaResultsChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- ZAK≈ÅADKA 4: INSTYTUCJE KULTURALNE -->
        <div id="e_kultura" class="tab-content">
            <div class="data-section-grid">
                
                <div class="data-preview card">
                    <h3>Liczba Odwiedzin w Muzeach (Rocznie)</h3>
                    <p class="main-metric">110 000</p>
                    <p class="change-info">‚Üë 10% wzrost popularno≈õci wystaw</p>
                </div>

                <div class="data-preview card">
                    <h3>Dotacje na Dzia≈Çalno≈õƒá KulturalnƒÖ (mln PLN)</h3>
                    <p class="main-metric">5.2 mln PLN</p>
                    <p class="change-info">Sta≈Çy poziom finansowania</p>
                </div>
                
                <div class="data-preview full-width chart-container">
                    <h3>Wykres Radarowy: Frekwencja w Plac√≥wkach Kulturalnych</h3>
                    <canvas id="cultureAttendanceChart"></canvas>
                </div>
            </div>
        </div>
        
    </div>
    
    <!-- LOGIKA JAVASCRIPT DLA PRZE≈ÅƒÑCZANIA ZAK≈ÅADEK I WZOR√ìW CHART.JS -->
    <script>
        // Funkcja do prze≈ÇƒÖczania zak≈Çadek (konieczna do dzia≈Çania)
        function switchTab(tabId, clickedButton) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
            clickedButton.classList.add('active');
            
            if (window.charts && window.charts[tabId]) {
                window.charts[tabId].update();
            } else {
                initializeCharts(tabId); 
            }
        }
        
        // Funkcja do symulacji ≈Çadowania danych na podstawie filtra
        function loadEducationData(type) {
            console.log("≈Åadowanie danych dla typu szko≈Çy:", type);
            // Tutaj logika AJAX do pobierania nowych metryk i od≈õwie≈ºania wykres√≥w
        }
        
        window.charts = window.charts || {};

        function initializeCharts(activeTabId) {
            if (typeof Chart === 'undefined') return;

            if (activeTabId === 'e_podsumowanie') {
                const ctx = document.getElementById('educationGrowthChart');
                if (ctx && !window.charts.e_podsumowanie) {
                    window.charts.e_podsumowanie = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['2019', '2020', '2021', '2022', '2023', '2024'],
                            datasets: [{
                                label: 'Liczba Uczni√≥w (Podst./≈örednie)',
                                data: [18000, 18200, 17800, 18100, 18000, 18100],
                                borderColor: '#1a73e8',
                                tension: 0.4,
                                fill: false
                            },
                            {
                                label: 'Liczba Student√≥w',
                                data: [6500, 6000, 5800, 5600, 5400, 5400],
                                borderColor: '#FF6384',
                                tension: 0.4,
                                fill: false
                            }]
                        },
                        options: { responsive: true }
                    });
                }
            } else if (activeTabId === 'e_szkolnictwo') {
                 const ctx = document.getElementById('studentLevelChart');
                if (ctx && !window.charts.e_szkolnictwo) {
                    window.charts.e_szkolnictwo = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Przedszkola', 'Podstawowe', '≈örednie', 'Policealne/Wy≈ºsze'],
                            datasets: [{
                                label: 'Liczba Uczni√≥w/Student√≥w',
                                data: [3500, 10500, 7000, 5500],
                                backgroundColor: ['#4BC0C0', '#36A2EB', '#FFCE56', '#FF6384'],
                            }]
                        },
                        options: { responsive: true, scales: { y: { beginAtZero: true } } }
                    });
                }
            } else if (activeTabId === 'e_wyniki') {
                const ctx = document.getElementById('maturaResultsChart');
                if (ctx && !window.charts.e_wyniki) {
                    window.charts.e_wyniki = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: ['J. Polski (≈örednia: 61%)', 'Matematyka (≈örednia: 58%)', 'J. Obcy (≈örednia: 78%)'],
                            datasets: [{
                                data: [61, 58, 78],
                                backgroundColor: ['#9966FF', '#FF9F40', '#00cc99']
                            }]
                        },
                        options: { responsive: true, plugins: { legend: { position: 'right' } } }
                    });
                }
            } else if (activeTabId === 'e_kultura') {
                const ctx = document.getElementById('cultureAttendanceChart');
                if (ctx && !window.charts.e_kultura) {
                     window.charts.e_kultura = new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: ['Muzea', 'Teatry', 'Biblioteki', 'Centra Kultury'],
                            datasets: [{
                                label: 'Odwiedziny (tys. os√≥b)',
                                data: [30, 15, 45, 20],
                                backgroundColor: 'rgba(26, 115, 232, 0.2)',
                                borderColor: '#1a73e8',
                                borderWidth: 2
                            }]
                        },
                        options: { responsive: true }
                    });
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
             initializeCharts('e_podsumowanie');
        });
    </script>
{% endblock %}
